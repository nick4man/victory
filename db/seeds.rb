# frozen_string_literal: true

puts '???? Starting database seeding...'

if Rails.env.development?
  puts '???????  Cleaning existing data...'
  PropertyView.delete_all
  Favorite.delete_all
  SavedSearch.delete_all
  Message.delete_all
  Review.delete_all
  Inquiry.delete_all
  Property.delete_all
  User.delete_all
  puts '??? Data cleaned'
end

puts '???? Creating admin user...'
admin = User.create!(
  email: 'admin@viktory-realty.ru',
  password: 'password123',
  password_confirmation: 'password123',
  first_name: '??????????????????????????',
  last_name: '??????????????',
  phone: '79991234567',
  role: 'admin',
  confirmed_at: Time.current
)
puts "??? Admin created: #{admin.email}"

puts '???? Creating agent user...'
agent = User.create!(
  email: 'manager@viktory-realty.ru',
  password: 'password123',
  password_confirmation: 'password123',
  first_name: '????????',
  last_name: '????????????????????',
  phone: '79992345678',
  role: 'agent',
  confirmed_at: Time.current
)
puts "??? Agent created: #{agent.email}"

puts '???? Creating test users...'
users = []
5.times do |i|
  user = User.create!(
    email: "user#{i + 1}@example.com",
    password: 'password123',
    password_confirmation: 'password123',
    first_name: ['??????????????????', '??????????', '??????????????', '??????????', '????????????'][i],
    last_name: ['????????????', '??????????????', '??????????????', '??????????????', '??????????????'][i],
    phone: "7999#{300 + i}#{1000 + i}",
    role: 'client',
    confirmed_at: Time.current
  )
  users << user
end
puts "??? Created #{users.count} test users"

puts '???? Creating properties...'
districts = ['??????????????????????', '????????????????', '??????????', '????????????????', '??????????????????']
properties = []
10.times do |i|
  property = Property.create!(
    user: admin,
    title: "???????????????? #{i+1} ?? ???????????? #{districts.sample}",
    description: "???????????????? ???????????????? ?? ?????????????? ????????????????. ???????????????? ????????????????????????????.",
    deal_type: ['sale', 'rent'].sample,
    price: rand(5_000_000..30_000_000),
    area: rand(40..120),
    rooms: rand(1..4),
    floor: rand(1..20),
    total_floors: 25,
    address: "????????????, ????. ??????????????????, ??. #{rand(1..100)}",
    district: districts.sample,
    condition: ['normal', 'renovated', 'euro'].sample,
    status: 'active'
  )
  properties << property
  print '.'
end
puts "\n??? Created #{properties.count} properties"

puts "\n???? Database seeding completed!"
puts "???? Admin: admin@viktory-realty.ru / password123"
